---
title: 'linux安全设置与配置'
date: '2025-08-20'
summary: 'linux常用的安全设置与配置'
tags: ['Linux']
draft: false
authors: ['default']
---



<!-- more -->

#### 1.添加公匙到服务器
- 在root权限下输入
vim .ssh/authorized_keys
- 找到本机用户的公匙ssh-pub,粘贴入即可

#### 2.修改连接条件只允许密匙，不允许密码，修改端口
- 输入命令
vim /etc/ssh/sshd_config 
- port：希望的端口
- PubkeyAuthentication yes
- 修改PasswordAuthentication注释，修改为no

#### 3.防火墙设置
- 查看防火墙状态
   firewall-cmd --state
- 查看防火墙所有信息
firewall-cmd --list-all
- 查看防火墙开放的端口信息
firewall-cmd --list-ports
- 启用防火墙
   service firewalld start
#### 3.1 添加防火墙允许端口
- 将端口9877设置为连接端口
- 说明:
- zone #作用域
- add-port=9877/tcp #添加端口，格式为：端口/通讯协议
- permanent 永久生效，没有此参数重启后失效

firewall-cmd --zone=public --add-port=9822/tcp --permanent

- 重新加载防火墙

firewall-cmd --reload

- 设置7001-7050为可用端口

firewall-cmd --zone=public --add-port=7001-7050/tcp --permanent

- 关闭防火墙：

  systemctl stop firewalld.service #停止firewall
  systemctl disable firewalld.service #禁止firewall开机启动

#### 3.2删除开放端口
- 删除80端口

firewall-cmd --zone=public --remove-port=80/tcp --permanent

#### 4.linux命令技巧
- 将本地文件复制到服务器
scp -P 9722 -r scjiaxing/ root@132.232.49.238:/var/www/

- 将服务器文件下载到本地
scp -P 5555  -r root@IP:/usr/local/shadowsocksr/mudb.json /E

#### 5.域名解析总结
* 6.1 如何添加二级域名
![](https://markdownimage-1257263724.cos.ap-chengdu.myqcloud.com/typroa/202109181013567.png)

#### 6.CentOS 7 升级 Linux 内核
- 6.1更新仓库
yum -y update

- 6.2启用 ELRepo 仓库
rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm

- 6.3查看可用的系统内核包
yum --disablerepo="*" --enablerepo="elrepo-kernel" list available

- 6.4安装最新内核

  yum --enablerepo=elrepo-kernel install kernel-m

- 6.5设置grub2
内核安装好后，需要设置为默认启动选项并重启后才会生效

- 6.6查看系统上的所有可以内核：
vim /etc/grub.con
![](https://markdownimage-1257263724.cos.ap-chengdu.myqcloud.com/typroa/202109181013897.png)

- 7.1 设置 GRUB_DEFAULT=0
vim /etc/default/grub  

- 7.2 编辑 /etc/grub.cfg
  ![](https://markdownimage-1257263724.cos.ap-chengdu.myqcloud.com/typroa/202109181014192.png)

- 7.3添加grub.cfg文件
cd /boot/grub2/
cp grub.cfg.bak grub.cfg
#### 7.检测服务器的状态
- ping服务器的ip
![](https://markdownimage-1257263724.cos.ap-chengdu.myqcloud.com/typroa/202109181014402.png)

#### 8.检测服务器网速
wget -qO- --no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash

#### 9.常用文件操作
- 将文件夹复制到指定目录下

cp -r 文件夹 /var/www/ 

- 删除文件夹

  rm -rf SCJiaXing/
  
- 文件夹重命名
mv A B

#### 10.查看linux的登录日志

#### 10.1 lastlog 列出所有用户最近登录的信息
- lastlog引用的是/var/log/lastlog文件中的信息，包括login-name、port、last login time
![](https://markdownimage-1257263724.cos.ap-chengdu.myqcloud.com/typroa/202109181014091.png)
#### 10.2 last  列出当前和曾经登入系统的用户信息
- 它默认读取的是/var/log/wtmp文件的信息。输出的内容包括：用户名、终端位置、登录源信息、开始时间、结束时间、持续时间。注意最后一行输出的是wtmp文件起始记录的时间。当然也可以通过last -f参数指定读取文件，可以是/var/log/btmp、/var/run/utmp
![](https://markdownimage-1257263724.cos.ap-chengdu.myqcloud.com/typroa/202109181014995.png)
#### 10.3 lastb列出失败尝试的登录信息
- 和last命令功能完全相同，只不过它默认读取的是/var/log/btmp文件的信息。当然也可以通过last -f参数指定读取文件，可以是/var/log/btmp、/var/run/utmp
![](https://markdownimage-1257263724.cos.ap-chengdu.myqcloud.com/typroa/202109181014806.png)

 <blockquote class="blockquote-center">判断Linux服务器架构是32位/64位</blockquote>

```bash
 getconf LONG_BIT
```

#### source命令用法

```bash
source fileName
```

- source命令的作用，在当前bash环境下读取并执行FileName中的命令。该命令通常用命令“.”来替代。". filename"中间有空格

##### linux查询前10行数据

```linux
 head -n 10 /etc/profile
```

#### 查看磁盘使用情况

```linux
df -m
df -k
```

#### 查看内存使用情况

```linux
top
```

- PID：当前运行进程的ID
- USER：进程属主
- PR：每个进程的优先级别
- NInice：反应一个进程“优先级”状态的值，其取值范围是-20至19，一
  　　　　共40个级别。这个值越小，表示进程”优先级”越高，而值越
  　　　　大“优先级”越低。一般会把nice值叫做静态优先级
- VIRT：进程占用的虚拟内存
- RES：进程占用的物理内存
- SHR：进程使用的共享内存
- S：进程的状态。S表示休眠，R表示正在运行，Z表示僵死状态，N表示
  　 该进程优先值为负数
- %CPU：进程占用CPU的使用率
- %MEM：进程使用的物理内存和总内存的百分比
- TIME+：该进程启动后占用的总的CPU时间，即占用CPU使用时间的累加值。
- COMMAND：进程启动命令名称

##### 权限修改

```linux
sudo chmod  777 /etc/squid

权限	权限数值	二进制	具体作用
r	4	00000100	read，读取。当前用户可以读取文件内容，当前用户可以浏览目录。
w	2	00000010	write，写入。当前用户可以新增或修改文件内容，当前用户可以删除、移动目录或目录内文件。
x	1	00000001	execute，执行。当前用户可以执行文件，当前用户可以进入目录。
```



